# Auto-generated symbolic field expressions for B
# This file is generated by _generate_bpmeth_to_C.py
# Do not edit it directly.

import math

def evaluate_B(x, y, s, params, multipole_order):
    """
    Auto-generated symbolic field evaluation for B.
    Parameters are expected as a flat sequence in ``params``.
    The meaning and ordering of the parameters match the C implementation.
    """
    if multipole_order == 1:
        # Parameter list
        bs_0 = params[0]
        bs_1 = params[1]
        bs_2 = params[2]
        bs_3 = params[3]
        bs_4 = params[4]
        kn_0_0 = params[5]
        kn_0_1 = params[6]
        kn_0_2 = params[7]
        kn_0_3 = params[8]
        kn_0_4 = params[9]
        ks_0_0 = params[10]
        ks_0_1 = params[11]
        ks_0_2 = params[12]
        ks_0_3 = params[13]
        ks_0_4 = params[14]

        # Common sub-expressions
        x0 = s**2
        x1 = s**3
        x2 = s**4
        x3 = y**2
        x4 = 3*ks_0_3
        x5 = 6*x0
        x6 = ks_0_2 + ks_0_4*x5 + s*x4
        x7 = 2*s
        x8 = 3*x0
        x9 = 4*x1

        # Reduced expressions
        Bx = ks_0_0 + ks_0_1*s + ks_0_2*x0 + ks_0_3*x1 + ks_0_4*x2 - x3*x6
        By = kn_0_0 + kn_0_1*s + kn_0_2*x0 + kn_0_3*x1 + kn_0_4*x2 - y*(bs_1 + bs_2*x7 + bs_3*x8 + bs_4*x9 + 2*x*x6)
        Bs = bs_0 + bs_1*s + bs_2*x0 + bs_3*x1 + bs_4*x2 + x*(ks_0_1 + ks_0_2*x7 + ks_0_4*x9 + x0*x4) - 1/2*x3*(2*bs_2 + 6*bs_3*s + 2*bs_4*x5 + 6*x*(ks_0_3 + 4*ks_0_4*s)) + y*(kn_0_1 + kn_0_2*x7 + kn_0_3*x8 + kn_0_4*x9)
        return Bx, By, Bs

    elif multipole_order == 2:
        # Parameter list
        bs_0 = params[0]
        bs_1 = params[1]
        bs_2 = params[2]
        bs_3 = params[3]
        bs_4 = params[4]
        kn_0_0 = params[5]
        kn_0_1 = params[6]
        kn_0_2 = params[7]
        kn_0_3 = params[8]
        kn_0_4 = params[9]
        kn_1_0 = params[10]
        kn_1_1 = params[11]
        kn_1_2 = params[12]
        kn_1_3 = params[13]
        kn_1_4 = params[14]
        ks_0_0 = params[15]
        ks_0_1 = params[16]
        ks_0_2 = params[17]
        ks_0_3 = params[18]
        ks_0_4 = params[19]
        ks_1_0 = params[20]
        ks_1_1 = params[21]
        ks_1_2 = params[22]
        ks_1_3 = params[23]
        ks_1_4 = params[24]

        # Common sub-expressions
        x0 = s**2
        x1 = s**3
        x2 = s**4
        x3 = y**3
        x4 = 3*s
        x5 = 6*x0
        x6 = kn_1_2 + kn_1_3*x4 + kn_1_4*x5
        x7 = ks_1_1*s
        x8 = ks_1_2*x0
        x9 = ks_1_3*x1
        x10 = ks_1_4*x2
        x11 = kn_1_0 + kn_1_1*s + kn_1_2*x0 + kn_1_3*x1 + kn_1_4*x2
        x12 = ks_0_2 + ks_0_3*x4 + ks_0_4*x5
        x13 = ks_1_2 + ks_1_3*x4 + ks_1_4*x5
        x14 = 4*x
        x15 = y**2
        x16 = (1/4)*x15
        x17 = 4*s
        x18 = 8*x1
        x19 = x**2
        x20 = 2*s
        x21 = 3*x0
        x22 = 4*x1

        # Reduced expressions
        Bx = ks_0_0 + ks_0_1*s + ks_0_2*x0 + ks_0_3*x1 + ks_0_4*x2 + x*(ks_1_0 + x10 + x7 + x8 + x9) + x11*y - x16*(4*x12 + x13*x14) - 1/3*x3*x6
        By = kn_0_0 + kn_0_1*s + kn_0_2*x0 + kn_0_3*x1 + kn_0_4*x2 + x*x11 - 1/2*x15*(2*kn_0_2 + 2*kn_0_3*x4 + 2*kn_0_4*x5 + 2*x*x6) - 1/2*y*(2*bs_1 + bs_2*x17 + bs_3*x5 + bs_4*x18 + 2*ks_1_0 + 2*x10 + x12*x14 + 2*x13*x19 + 2*x7 + 2*x8 + 2*x9)
        Bs = bs_0 + bs_1*s + bs_2*x0 + bs_3*x1 + bs_4*x2 + x*(ks_0_1 + ks_0_2*x20 + ks_0_3*x21 + ks_0_4*x22) - x16*(4*bs_2 + 4*bs_3*x4 + 4*bs_4*x5 + 2*ks_1_1 + ks_1_2*x17 + ks_1_3*x5 + ks_1_4*x18 + 12*x*(ks_0_3 + ks_0_4*x17) + 6*x19*(ks_1_3 + ks_1_4*x17)) + (1/2)*x19*(ks_1_1 + ks_1_2*x20 + ks_1_3*x21 + ks_1_4*x22) - 1/6*x3*(6*kn_0_3 + 6*kn_0_4*x17 + 6*x*(kn_1_3 + kn_1_4*x17)) + y*(kn_0_1 + kn_0_2*x20 + kn_0_3*x21 + kn_0_4*x22 + x*(kn_1_1 + kn_1_2*x20 + kn_1_3*x21 + kn_1_4*x22))
        return Bx, By, Bs

    elif multipole_order == 3:
        # Parameter list
        bs_0 = params[0]
        bs_1 = params[1]
        bs_2 = params[2]
        bs_3 = params[3]
        bs_4 = params[4]
        kn_0_0 = params[5]
        kn_0_1 = params[6]
        kn_0_2 = params[7]
        kn_0_3 = params[8]
        kn_0_4 = params[9]
        kn_1_0 = params[10]
        kn_1_1 = params[11]
        kn_1_2 = params[12]
        kn_1_3 = params[13]
        kn_1_4 = params[14]
        kn_2_0 = params[15]
        kn_2_1 = params[16]
        kn_2_2 = params[17]
        kn_2_3 = params[18]
        kn_2_4 = params[19]
        ks_0_0 = params[20]
        ks_0_1 = params[21]
        ks_0_2 = params[22]
        ks_0_3 = params[23]
        ks_0_4 = params[24]
        ks_1_0 = params[25]
        ks_1_1 = params[26]
        ks_1_2 = params[27]
        ks_1_3 = params[28]
        ks_1_4 = params[29]
        ks_2_0 = params[30]
        ks_2_1 = params[31]
        ks_2_2 = params[32]
        ks_2_3 = params[33]
        ks_2_4 = params[34]

        # Common sub-expressions
        x0 = s**2
        x1 = s**3
        x2 = s**4
        x3 = ks_1_1*s
        x4 = ks_1_2*x0
        x5 = ks_1_3*x1
        x6 = ks_1_4*x2
        x7 = ks_2_1*s
        x8 = ks_2_2*x0
        x9 = ks_2_3*x1
        x10 = ks_2_4*x2
        x11 = ks_2_0 + x10 + x7 + x8 + x9
        x12 = x**2
        x13 = (1/2)*x12
        x14 = 144*ks_0_4
        x15 = 72*x12
        x16 = 3*s
        x17 = 6*x0
        x18 = ks_2_2 + ks_2_3*x16 + ks_2_4*x17
        x19 = (1/144)*y**4
        x20 = kn_1_2 + kn_1_3*x16 + kn_1_4*x17
        x21 = kn_2_2 + kn_2_3*x16 + kn_2_4*x17
        x22 = 4*x
        x23 = y**3
        x24 = (1/12)*x23
        x25 = kn_1_1*s
        x26 = kn_1_2*x0
        x27 = kn_1_3*x1
        x28 = kn_1_4*x2
        x29 = kn_2_1*s
        x30 = kn_2_2*x0
        x31 = kn_2_3*x1
        x32 = kn_2_4*x2
        x33 = kn_2_0 + x29 + x30 + x31 + x32
        x34 = 2*x
        x35 = (1/2)*y
        x36 = ks_0_2 + ks_0_3*x16 + ks_0_4*x17
        x37 = ks_1_2 + ks_1_3*x16 + ks_1_4*x17
        x38 = 12*x
        x39 = 6*x12
        x40 = y**2
        x41 = (1/12)*x40
        x42 = x**3
        x43 = 4*s
        x44 = 12*s
        x45 = 18*x0
        x46 = 24*x1
        x47 = 6*x
        x48 = 2*s
        x49 = 3*x0
        x50 = 4*x1
        x51 = ks_2_1 + ks_2_2*x48 + ks_2_3*x49 + ks_2_4*x50
        x52 = ks_1_3 + ks_1_4*x43
        x53 = ks_2_3 + ks_2_4*x43
        x54 = 8*x1

        # Reduced expressions
        Bx = ks_0_0 + ks_0_1*s + ks_0_2*x0 + ks_0_3*x1 + ks_0_4*x2 + x*(ks_1_0 + x3 + x4 + x5 + x6) + x11*x13 + x19*(144*ks_1_4*x + ks_2_4*x15 + x14 + 24*x18) - x24*(4*x20 + x21*x22) + x35*(2*kn_1_0 + 2*x25 + 2*x26 + 2*x27 + 2*x28 + x33*x34) - x41*(6*ks_2_0 + 6*x10 + x18*x39 + 12*x36 + x37*x38 + 6*x7 + 6*x8 + 6*x9)
        By = kn_0_0 + kn_0_1*s + kn_0_2*x0 + kn_0_3*x1 + kn_0_4*x2 + x*(kn_1_0 + x25 + x26 + x27 + x28) + x13*x33 + (1/36)*x23*(36*bs_3 + 36*bs_4*x43 + ks_1_4*x15 + 24*ks_2_4*x42 + x*x14 + 24*x*x18 + 24*x37) - 1/4*x40*(4*kn_0_2 + 4*kn_0_3*x16 + 4*kn_0_4*x17 + 2*kn_2_0 + 2*x12*x21 + x20*x22 + 2*x29 + 2*x30 + 2*x31 + 2*x32) - 1/6*y*(6*bs_1 + bs_2*x44 + bs_3*x45 + bs_4*x46 + 6*ks_1_0 + x11*x47 + 2*x18*x42 + 6*x3 + x36*x38 + x37*x39 + 6*x4 + 6*x5 + 6*x6)
        Bs = bs_0 + bs_1*s + bs_2*x0 + bs_3*x1 + bs_4*x2 + x*(ks_0_1 + ks_0_2*x48 + ks_0_3*x49 + ks_0_4*x50) + x13*(ks_1_1 + ks_1_2*x48 + ks_1_3*x49 + ks_1_4*x50) + x19*(144*bs_4 + 72*x*x53 + 72*x52) - x24*(12*kn_0_3 + 12*kn_0_4*x43 + 2*kn_2_1 + kn_2_2*x43 + kn_2_3*x17 + kn_2_4*x54 + x38*(kn_1_3 + kn_1_4*x43) + x39*(kn_2_3 + kn_2_4*x43)) + x35*(2*kn_0_1 + kn_0_2*x43 + kn_0_3*x17 + kn_0_4*x54 + x12*(kn_2_1 + kn_2_2*x48 + kn_2_3*x49 + kn_2_4*x50) + x34*(kn_1_1 + kn_1_2*x48 + kn_1_3*x49 + kn_1_4*x50)) - x41*(12*bs_2 + 12*bs_3*x16 + 12*bs_4*x17 + 6*ks_1_1 + ks_1_2*x44 + ks_1_3*x45 + ks_1_4*x46 + 36*x*(ks_0_3 + ks_0_4*x43) + 18*x12*x52 + 6*x42*x53 + x47*x51) + (1/6)*x42*x51
        return Bx, By, Bs

    elif multipole_order == 4:
        # Parameter list
        bs_0 = params[0]
        bs_1 = params[1]
        bs_2 = params[2]
        bs_3 = params[3]
        bs_4 = params[4]
        kn_0_0 = params[5]
        kn_0_1 = params[6]
        kn_0_2 = params[7]
        kn_0_3 = params[8]
        kn_0_4 = params[9]
        kn_1_0 = params[10]
        kn_1_1 = params[11]
        kn_1_2 = params[12]
        kn_1_3 = params[13]
        kn_1_4 = params[14]
        kn_2_0 = params[15]
        kn_2_1 = params[16]
        kn_2_2 = params[17]
        kn_2_3 = params[18]
        kn_2_4 = params[19]
        kn_3_0 = params[20]
        kn_3_1 = params[21]
        kn_3_2 = params[22]
        kn_3_3 = params[23]
        kn_3_4 = params[24]
        ks_0_0 = params[25]
        ks_0_1 = params[26]
        ks_0_2 = params[27]
        ks_0_3 = params[28]
        ks_0_4 = params[29]
        ks_1_0 = params[30]
        ks_1_1 = params[31]
        ks_1_2 = params[32]
        ks_1_3 = params[33]
        ks_1_4 = params[34]
        ks_2_0 = params[35]
        ks_2_1 = params[36]
        ks_2_2 = params[37]
        ks_2_3 = params[38]
        ks_2_4 = params[39]
        ks_3_0 = params[40]
        ks_3_1 = params[41]
        ks_3_2 = params[42]
        ks_3_3 = params[43]
        ks_3_4 = params[44]

        # Common sub-expressions
        x0 = s**2
        x1 = s**3
        x2 = s**4
        x3 = ks_1_1*s
        x4 = ks_1_2*x0
        x5 = ks_1_3*x1
        x6 = ks_1_4*x2
        x7 = ks_2_1*s
        x8 = ks_2_2*x0
        x9 = ks_2_3*x1
        x10 = ks_2_4*x2
        x11 = ks_2_0 + x10 + x7 + x8 + x9
        x12 = x**2
        x13 = (1/2)*x12
        x14 = ks_3_1*s
        x15 = ks_3_2*x0
        x16 = ks_3_3*x1
        x17 = ks_3_4*x2
        x18 = ks_3_0 + x14 + x15 + x16 + x17
        x19 = x**3
        x20 = (1/6)*x19
        x21 = 144*kn_1_4
        x22 = 144*x
        x23 = 72*x12
        x24 = 3*s
        x25 = 6*x0
        x26 = kn_3_2 + kn_3_3*x24 + kn_3_4*x25
        x27 = (1/720)*y**5
        x28 = 576*ks_0_4
        x29 = 288*x12
        x30 = 96*x19
        x31 = ks_2_2 + ks_2_3*x24 + ks_2_4*x25
        x32 = ks_3_2 + ks_3_3*x24 + ks_3_4*x25
        x33 = 96*x
        x34 = y**4
        x35 = (1/576)*x34
        x36 = kn_1_1*s
        x37 = kn_1_2*x0
        x38 = kn_1_3*x1
        x39 = kn_1_4*x2
        x40 = kn_2_1*s
        x41 = kn_2_2*x0
        x42 = kn_2_3*x1
        x43 = kn_2_4*x2
        x44 = kn_2_0 + x40 + x41 + x42 + x43
        x45 = 6*x
        x46 = kn_3_1*s
        x47 = kn_3_2*x0
        x48 = kn_3_3*x1
        x49 = kn_3_4*x2
        x50 = kn_3_0 + x46 + x47 + x48 + x49
        x51 = 3*x12
        x52 = (1/6)*y
        x53 = kn_1_2 + kn_1_3*x24 + kn_1_4*x25
        x54 = kn_2_2 + kn_2_3*x24 + kn_2_4*x25
        x55 = 12*x
        x56 = 6*x12
        x57 = y**3
        x58 = (1/36)*x57
        x59 = ks_0_2 + ks_0_3*x24 + ks_0_4*x25
        x60 = ks_1_2 + ks_1_3*x24 + ks_1_4*x25
        x61 = 48*x
        x62 = 24*x12
        x63 = 8*x19
        x64 = 24*x
        x65 = y**2
        x66 = (1/48)*x65
        x67 = 24*x19
        x68 = x**4
        x69 = 4*s
        x70 = 48*s
        x71 = 72*x0
        x72 = 96*x1
        x73 = 12*x12
        x74 = 2*s
        x75 = 3*x0
        x76 = 4*x1
        x77 = ks_2_1 + ks_2_2*x74 + ks_2_3*x75 + ks_2_4*x76
        x78 = ks_3_1 + ks_3_2*x74 + ks_3_3*x75 + ks_3_4*x76
        x79 = kn_2_3 + kn_2_4*x69
        x80 = kn_3_3 + kn_3_4*x69
        x81 = ks_1_3 + ks_1_4*x69
        x82 = ks_2_3 + ks_2_4*x69
        x83 = ks_3_3 + ks_3_4*x69
        x84 = 12*s
        x85 = 18*x0
        x86 = 24*x1
        x87 = kn_3_1 + kn_3_2*x74 + kn_3_3*x75 + kn_3_4*x76

        # Reduced expressions
        Bx = ks_0_0 + ks_0_1*s + ks_0_2*x0 + ks_0_3*x1 + ks_0_4*x2 + x*(ks_1_0 + x3 + x4 + x5 + x6) + x11*x13 + x18*x20 + x27*(kn_2_4*x22 + kn_3_4*x23 + x21 + 24*x26) + x35*(576*ks_1_4*x + ks_2_4*x29 + ks_3_4*x30 + x28 + 96*x31 + x32*x33) + x52*(6*kn_1_0 + 6*x36 + 6*x37 + 6*x38 + 6*x39 + x44*x45 + x50*x51) - x58*(6*kn_3_0 + x26*x56 + 6*x46 + 6*x47 + 6*x48 + 6*x49 + 12*x53 + x54*x55) - x66*(24*ks_2_0 + 24*x10 + x18*x64 + x31*x62 + x32*x63 + 48*x59 + x60*x61 + 24*x7 + 24*x8 + 24*x9)
        By = kn_0_0 + kn_0_1*s + kn_0_2*x0 + kn_0_3*x1 + kn_0_4*x2 + x*(kn_1_0 + x36 + x37 + x38 + x39) + x13*x44 + x20*x50 + (1/144)*x34*(144*kn_0_4 + kn_2_4*x23 + kn_3_4*x67 + x*x21 + x26*x64 + 24*x54) + (1/144)*x57*(144*bs_3 + 144*bs_4*x69 + ks_1_4*x29 + ks_2_4*x30 + 24*ks_3_0 + 24*ks_3_4*x68 + x*x28 + 48*x12*x32 + 24*x14 + 24*x15 + 24*x16 + 24*x17 + x31*x33 + 96*x60) - 1/12*x65*(12*kn_0_2 + 12*kn_0_3*x24 + 12*kn_0_4*x25 + 6*kn_2_0 + 2*x19*x26 + 6*x40 + 6*x41 + 6*x42 + 6*x43 + x45*x50 + x53*x55 + x54*x56) - 1/24*y*(24*bs_1 + bs_2*x70 + bs_3*x71 + bs_4*x72 + 24*ks_1_0 + x11*x64 + x18*x73 + 24*x3 + x31*x63 + 2*x32*x68 + 24*x4 + 24*x5 + x59*x61 + 24*x6 + x60*x62)
        Bs = bs_0 + bs_1*s + bs_2*x0 + bs_3*x1 + bs_4*x2 + x*(ks_0_1 + ks_0_2*x74 + ks_0_3*x75 + ks_0_4*x76) + x13*(ks_1_1 + ks_1_2*x74 + ks_1_3*x75 + ks_1_4*x76) + x20*x77 + x27*(72*x*x80 + 72*x79) + x35*(576*bs_4 + 24*ks_3_1 + ks_3_2*x70 + ks_3_3*x71 + ks_3_4*x72 + 288*x*x82 + 144*x12*x83 + 288*x81) + x52*(6*kn_0_1 + kn_0_2*x84 + kn_0_3*x85 + kn_0_4*x86 + x19*x87 + x45*(kn_1_1 + kn_1_2*x74 + kn_1_3*x75 + kn_1_4*x76) + x51*(kn_2_1 + kn_2_2*x74 + kn_2_3*x75 + kn_2_4*x76)) - x58*(36*kn_0_3 + 36*kn_0_4*x69 + 6*kn_2_1 + kn_2_2*x84 + kn_2_3*x85 + kn_2_4*x86 + 36*x*(kn_1_3 + kn_1_4*x69) + 18*x12*x79 + 6*x19*x80 + x45*x87) - x66*(48*bs_2 + 48*bs_3*x24 + 48*bs_4*x25 + 24*ks_1_1 + ks_1_2*x70 + ks_1_3*x71 + ks_1_4*x72 + x22*(ks_0_3 + ks_0_4*x69) + x23*x81 + x64*x77 + x67*x82 + 6*x68*x83 + x73*x78) + (1/24)*x68*x78
        return Bx, By, Bs

    elif multipole_order == 5:
        # Parameter list
        bs_0 = params[0]
        bs_1 = params[1]
        bs_2 = params[2]
        bs_3 = params[3]
        bs_4 = params[4]
        kn_0_0 = params[5]
        kn_0_1 = params[6]
        kn_0_2 = params[7]
        kn_0_3 = params[8]
        kn_0_4 = params[9]
        kn_1_0 = params[10]
        kn_1_1 = params[11]
        kn_1_2 = params[12]
        kn_1_3 = params[13]
        kn_1_4 = params[14]
        kn_2_0 = params[15]
        kn_2_1 = params[16]
        kn_2_2 = params[17]
        kn_2_3 = params[18]
        kn_2_4 = params[19]
        kn_3_0 = params[20]
        kn_3_1 = params[21]
        kn_3_2 = params[22]
        kn_3_3 = params[23]
        kn_3_4 = params[24]
        kn_4_0 = params[25]
        kn_4_1 = params[26]
        kn_4_2 = params[27]
        kn_4_3 = params[28]
        kn_4_4 = params[29]
        ks_0_0 = params[30]
        ks_0_1 = params[31]
        ks_0_2 = params[32]
        ks_0_3 = params[33]
        ks_0_4 = params[34]
        ks_1_0 = params[35]
        ks_1_1 = params[36]
        ks_1_2 = params[37]
        ks_1_3 = params[38]
        ks_1_4 = params[39]
        ks_2_0 = params[40]
        ks_2_1 = params[41]
        ks_2_2 = params[42]
        ks_2_3 = params[43]
        ks_2_4 = params[44]
        ks_3_0 = params[45]
        ks_3_1 = params[46]
        ks_3_2 = params[47]
        ks_3_3 = params[48]
        ks_3_4 = params[49]
        ks_4_0 = params[50]
        ks_4_1 = params[51]
        ks_4_2 = params[52]
        ks_4_3 = params[53]
        ks_4_4 = params[54]

        # Common sub-expressions
        x0 = s**2
        x1 = s**3
        x2 = s**4
        x3 = ks_1_1*s
        x4 = ks_1_2*x0
        x5 = ks_1_3*x1
        x6 = ks_1_4*x2
        x7 = ks_2_1*s
        x8 = ks_2_2*x0
        x9 = ks_2_3*x1
        x10 = ks_2_4*x2
        x11 = ks_2_0 + x10 + x7 + x8 + x9
        x12 = x**2
        x13 = (1/2)*x12
        x14 = ks_3_1*s
        x15 = ks_3_2*x0
        x16 = ks_3_3*x1
        x17 = ks_3_4*x2
        x18 = ks_3_0 + x14 + x15 + x16 + x17
        x19 = x**3
        x20 = (1/6)*x19
        x21 = ks_4_1*s
        x22 = ks_4_2*x0
        x23 = ks_4_3*x1
        x24 = ks_4_4*x2
        x25 = ks_4_0 + x21 + x22 + x23 + x24
        x26 = x**4
        x27 = (1/24)*x26
        x28 = 8640*ks_2_4
        x29 = 4320*x12
        x30 = 3*s
        x31 = 6*x0
        x32 = ks_4_2 + ks_4_3*x30 + ks_4_4*x31
        x33 = (1/86400)*y**6
        x34 = 576*kn_1_4
        x35 = 288*x12
        x36 = 96*x19
        x37 = kn_3_2 + kn_3_3*x30 + kn_3_4*x31
        x38 = kn_4_2 + kn_4_3*x30 + kn_4_4*x31
        x39 = 96*x
        x40 = y**5
        x41 = (1/2880)*x40
        x42 = kn_1_1*s
        x43 = kn_1_2*x0
        x44 = kn_1_3*x1
        x45 = kn_1_4*x2
        x46 = kn_2_1*s
        x47 = kn_2_2*x0
        x48 = kn_2_3*x1
        x49 = kn_2_4*x2
        x50 = kn_2_0 + x46 + x47 + x48 + x49
        x51 = 24*x
        x52 = kn_3_1*s
        x53 = kn_3_2*x0
        x54 = kn_3_3*x1
        x55 = kn_3_4*x2
        x56 = kn_3_0 + x52 + x53 + x54 + x55
        x57 = 12*x12
        x58 = kn_4_1*s
        x59 = kn_4_2*x0
        x60 = kn_4_3*x1
        x61 = kn_4_4*x2
        x62 = kn_4_0 + x58 + x59 + x60 + x61
        x63 = 4*x19
        x64 = (1/24)*y
        x65 = 2880*ks_0_4
        x66 = 1440*x12
        x67 = 480*x19
        x68 = 120*x26
        x69 = ks_2_2 + ks_2_3*x30 + ks_2_4*x31
        x70 = ks_3_2 + ks_3_3*x30 + ks_3_4*x31
        x71 = 480*x
        x72 = 240*x12
        x73 = y**4
        x74 = (1/2880)*x73
        x75 = kn_1_2 + kn_1_3*x30 + kn_1_4*x31
        x76 = kn_2_2 + kn_2_3*x30 + kn_2_4*x31
        x77 = 48*x
        x78 = 24*x12
        x79 = 8*x19
        x80 = y**3
        x81 = (1/144)*x80
        x82 = ks_0_2 + ks_0_3*x30 + ks_0_4*x31
        x83 = ks_1_2 + ks_1_3*x30 + ks_1_4*x31
        x84 = 240*x
        x85 = 120*x12
        x86 = 40*x19
        x87 = 10*x26
        x88 = 120*x
        x89 = 60*x12
        x90 = y**2
        x91 = (1/240)*x90
        x92 = 720*x
        x93 = x**5
        x94 = 4*s
        x95 = 240*s
        x96 = 360*x0
        x97 = 480*x1
        x98 = 20*x19
        x99 = 2*s
        x100 = 3*x0
        x101 = 4*x1
        x102 = ks_2_1 + ks_2_2*x99 + ks_2_3*x100 + ks_2_4*x101
        x103 = ks_3_1 + ks_3_2*x99 + ks_3_3*x100 + ks_3_4*x101
        x104 = ks_4_1 + ks_4_2*x99 + ks_4_3*x100 + ks_4_4*x101
        x105 = ks_3_3 + ks_3_4*x94
        x106 = ks_4_3 + ks_4_4*x94
        x107 = 48*s
        x108 = 72*x0
        x109 = 96*x1
        x110 = kn_2_3 + kn_2_4*x94
        x111 = kn_3_3 + kn_3_4*x94
        x112 = kn_4_3 + kn_4_4*x94
        x113 = ks_1_3 + ks_1_4*x94
        x114 = ks_2_3 + ks_2_4*x94
        x115 = kn_4_1 + kn_4_2*x99 + kn_4_3*x100 + kn_4_4*x101
        x116 = kn_3_1 + kn_3_2*x99 + kn_3_3*x100 + kn_3_4*x101

        # Reduced expressions
        Bx = ks_0_0 + ks_0_1*s + ks_0_2*x0 + ks_0_3*x1 + ks_0_4*x2 + x*(ks_1_0 + x3 + x4 + x5 + x6) + x11*x13 + x18*x20 + x25*x27 - x33*(8640*ks_3_4*x + ks_4_4*x29 + x28 + 720*x32) + x41*(576*kn_2_4*x + kn_3_4*x35 + kn_4_4*x36 + x34 + 96*x37 + x38*x39) + x64*(24*kn_1_0 + 24*x42 + 24*x43 + 24*x44 + 24*x45 + x50*x51 + x56*x57 + x62*x63) + x74*(2880*ks_1_4*x + ks_2_4*x66 + ks_3_4*x67 + 120*ks_4_0 + ks_4_4*x68 + 120*x21 + 120*x22 + 120*x23 + 120*x24 + x32*x72 + x65 + 480*x69 + x70*x71) - x81*(24*kn_3_0 + x37*x78 + x38*x79 + x51*x62 + 24*x52 + 24*x53 + 24*x54 + 24*x55 + 48*x75 + x76*x77) - x91*(120*ks_2_0 + 120*x10 + x18*x88 + x25*x89 + x32*x87 + x69*x85 + 120*x7 + x70*x86 + 120*x8 + 240*x82 + x83*x84 + 120*x9)
        By = kn_0_0 + kn_0_1*s + kn_0_2*x0 + kn_0_3*x1 + kn_0_4*x2 + x*(kn_1_0 + x42 + x43 + x44 + x45) + x13*x50 + x20*x56 + x27*x62 - 1/14400*x40*(8640*ks_1_4 + ks_3_4*x29 + 1440*ks_4_4*x19 + x*x28 + x32*x92 + 720*x70) + (1/576)*x73*(576*kn_0_4 + kn_2_4*x35 + kn_3_4*x36 + 24*kn_4_0 + 24*kn_4_4*x26 + x*x34 + 48*x12*x38 + x37*x39 + 24*x58 + 24*x59 + 24*x60 + 24*x61 + 96*x76) + (1/720)*x80*(720*bs_3 + 720*bs_4*x94 + ks_1_4*x66 + ks_2_4*x67 + 120*ks_3_0 + ks_3_4*x68 + 24*ks_4_4*x93 + x*x65 + 120*x14 + 120*x15 + 120*x16 + 120*x17 + 80*x19*x32 + x25*x88 + x69*x71 + x70*x72 + 480*x83) - 1/48*x90*(48*kn_0_2 + 48*kn_0_3*x30 + 48*kn_0_4*x31 + 24*kn_2_0 + 2*x26*x38 + x37*x79 + 24*x46 + 24*x47 + 24*x48 + 24*x49 + x51*x56 + x57*x62 + x75*x77 + x76*x78) - 1/120*y*(120*bs_1 + bs_2*x95 + bs_3*x96 + bs_4*x97 + 120*ks_1_0 + x11*x88 + x18*x89 + x25*x98 + 120*x3 + 2*x32*x93 + 120*x4 + 120*x5 + 120*x6 + x69*x86 + x70*x87 + x82*x84 + x83*x85)
        Bs = bs_0 + bs_1*s + bs_2*x0 + bs_3*x1 + bs_4*x2 + x*(ks_0_1 + ks_0_2*x99 + ks_0_3*x100 + ks_0_4*x101) + x102*x20 + x103*x27 + (1/120)*x104*x93 + x13*(ks_1_1 + ks_1_2*x99 + ks_1_3*x100 + ks_1_4*x101) - x33*(2160*x*x106 + 2160*x105) + x41*(24*kn_4_1 + kn_4_2*x107 + kn_4_3*x108 + kn_4_4*x109 + 288*x*x111 + 288*x110 + 144*x112*x12) + x64*(24*kn_0_1 + kn_0_2*x107 + kn_0_3*x108 + kn_0_4*x109 + x115*x26 + x116*x63 + x51*(kn_1_1 + kn_1_2*x99 + kn_1_3*x100 + kn_1_4*x101) + x57*(kn_2_1 + kn_2_2*x99 + kn_2_3*x100 + kn_2_4*x101)) + x74*(2880*bs_4 + 120*ks_3_1 + ks_3_2*x95 + ks_3_3*x96 + ks_3_4*x97 + 1440*x*x114 + x104*x88 + 720*x105*x12 + 240*x106*x19 + 1440*x113) - x81*(144*kn_0_3 + 144*kn_0_4*x94 + 24*kn_2_1 + kn_2_2*x107 + kn_2_3*x108 + kn_2_4*x109 + 144*x*(kn_1_3 + kn_1_4*x94) + 72*x110*x12 + 24*x111*x19 + 6*x112*x26 + x115*x57 + x116*x51) - x91*(240*bs_2 + 240*bs_3*x30 + 240*bs_4*x31 + 120*ks_1_1 + ks_1_2*x95 + ks_1_3*x96 + ks_1_4*x97 + x102*x88 + x103*x89 + x104*x98 + 30*x105*x26 + 6*x106*x93 + 360*x113*x12 + 120*x114*x19 + x92*(ks_0_3 + ks_0_4*x94))
        return Bx, By, Bs

    elif multipole_order == 6:
        # Parameter list
        bs_0 = params[0]
        bs_1 = params[1]
        bs_2 = params[2]
        bs_3 = params[3]
        bs_4 = params[4]
        kn_0_0 = params[5]
        kn_0_1 = params[6]
        kn_0_2 = params[7]
        kn_0_3 = params[8]
        kn_0_4 = params[9]
        kn_1_0 = params[10]
        kn_1_1 = params[11]
        kn_1_2 = params[12]
        kn_1_3 = params[13]
        kn_1_4 = params[14]
        kn_2_0 = params[15]
        kn_2_1 = params[16]
        kn_2_2 = params[17]
        kn_2_3 = params[18]
        kn_2_4 = params[19]
        kn_3_0 = params[20]
        kn_3_1 = params[21]
        kn_3_2 = params[22]
        kn_3_3 = params[23]
        kn_3_4 = params[24]
        kn_4_0 = params[25]
        kn_4_1 = params[26]
        kn_4_2 = params[27]
        kn_4_3 = params[28]
        kn_4_4 = params[29]
        kn_5_0 = params[30]
        kn_5_1 = params[31]
        kn_5_2 = params[32]
        kn_5_3 = params[33]
        kn_5_4 = params[34]
        ks_0_0 = params[35]
        ks_0_1 = params[36]
        ks_0_2 = params[37]
        ks_0_3 = params[38]
        ks_0_4 = params[39]
        ks_1_0 = params[40]
        ks_1_1 = params[41]
        ks_1_2 = params[42]
        ks_1_3 = params[43]
        ks_1_4 = params[44]
        ks_2_0 = params[45]
        ks_2_1 = params[46]
        ks_2_2 = params[47]
        ks_2_3 = params[48]
        ks_2_4 = params[49]
        ks_3_0 = params[50]
        ks_3_1 = params[51]
        ks_3_2 = params[52]
        ks_3_3 = params[53]
        ks_3_4 = params[54]
        ks_4_0 = params[55]
        ks_4_1 = params[56]
        ks_4_2 = params[57]
        ks_4_3 = params[58]
        ks_4_4 = params[59]
        ks_5_0 = params[60]
        ks_5_1 = params[61]
        ks_5_2 = params[62]
        ks_5_3 = params[63]
        ks_5_4 = params[64]

        # Common sub-expressions
        x0 = s**2
        x1 = s**3
        x2 = s**4
        x3 = ks_1_1*s
        x4 = ks_1_2*x0
        x5 = ks_1_3*x1
        x6 = ks_1_4*x2
        x7 = ks_2_1*s
        x8 = ks_2_2*x0
        x9 = ks_2_3*x1
        x10 = ks_2_4*x2
        x11 = ks_2_0 + x10 + x7 + x8 + x9
        x12 = x**2
        x13 = (1/2)*x12
        x14 = ks_3_1*s
        x15 = ks_3_2*x0
        x16 = ks_3_3*x1
        x17 = ks_3_4*x2
        x18 = ks_3_0 + x14 + x15 + x16 + x17
        x19 = x**3
        x20 = (1/6)*x19
        x21 = ks_4_1*s
        x22 = ks_4_2*x0
        x23 = ks_4_3*x1
        x24 = ks_4_4*x2
        x25 = ks_4_0 + x21 + x22 + x23 + x24
        x26 = x**4
        x27 = (1/24)*x26
        x28 = ks_5_1*s
        x29 = ks_5_2*x0
        x30 = ks_5_3*x1
        x31 = ks_5_4*x2
        x32 = ks_5_0 + x28 + x29 + x30 + x31
        x33 = x**5
        x34 = (1/120)*x33
        x35 = 8640*kn_3_4
        x36 = 8640*x
        x37 = 4320*x12
        x38 = 3*s
        x39 = 6*x0
        x40 = kn_5_2 + kn_5_3*x38 + kn_5_4*x39
        x41 = (1/604800)*y**7
        x42 = 51840*ks_2_4
        x43 = 25920*x12
        x44 = 8640*x19
        x45 = ks_4_2 + ks_4_3*x38 + ks_4_4*x39
        x46 = ks_5_2 + ks_5_3*x38 + ks_5_4*x39
        x47 = 4320*x
        x48 = y**6
        x49 = (1/518400)*x48
        x50 = 2880*kn_1_4
        x51 = 2880*x
        x52 = kn_5_1*s
        x53 = 1440*x12
        x54 = 480*x19
        x55 = kn_5_2*x0
        x56 = kn_5_3*x1
        x57 = kn_5_4*x2
        x58 = 120*x26
        x59 = kn_3_2 + kn_3_3*x38 + kn_3_4*x39
        x60 = kn_4_2 + kn_4_3*x38 + kn_4_4*x39
        x61 = 480*x
        x62 = 240*x12
        x63 = y**5
        x64 = (1/14400)*x63
        x65 = kn_1_1*s
        x66 = kn_1_2*x0
        x67 = kn_1_3*x1
        x68 = kn_1_4*x2
        x69 = kn_2_1*s
        x70 = kn_2_2*x0
        x71 = kn_2_3*x1
        x72 = kn_2_4*x2
        x73 = kn_2_0 + x69 + x70 + x71 + x72
        x74 = 120*x
        x75 = kn_3_1*s
        x76 = kn_3_2*x0
        x77 = kn_3_3*x1
        x78 = kn_3_4*x2
        x79 = kn_3_0 + x75 + x76 + x77 + x78
        x80 = 60*x12
        x81 = kn_4_1*s
        x82 = kn_4_2*x0
        x83 = kn_4_3*x1
        x84 = kn_4_4*x2
        x85 = kn_4_0 + x81 + x82 + x83 + x84
        x86 = 20*x19
        x87 = kn_5_0 + x52 + x55 + x56 + x57
        x88 = 5*x26
        x89 = (1/120)*y
        x90 = 17280*ks_0_4
        x91 = 8640*x12
        x92 = 2880*x19
        x93 = 720*x26
        x94 = 144*x33
        x95 = ks_2_2 + ks_2_3*x38 + ks_2_4*x39
        x96 = ks_3_2 + ks_3_3*x38 + ks_3_4*x39
        x97 = 720*x
        x98 = y**4
        x99 = (1/17280)*x98
        x100 = kn_1_2 + kn_1_3*x38 + kn_1_4*x39
        x101 = kn_2_2 + kn_2_3*x38 + kn_2_4*x39
        x102 = 240*x
        x103 = 120*x12
        x104 = 40*x19
        x105 = 10*x26
        x106 = y**3
        x107 = (1/720)*x106
        x108 = ks_0_2 + ks_0_3*x38 + ks_0_4*x39
        x109 = ks_1_2 + ks_1_3*x38 + ks_1_4*x39
        x110 = 1440*x
        x111 = 720*x12
        x112 = 240*x19
        x113 = 60*x26
        x114 = 12*x33
        x115 = 360*x12
        x116 = 120*x19
        x117 = y**2
        x118 = (1/1440)*x117
        x119 = 1440*x19
        x120 = 2160*x12
        x121 = x**6
        x122 = 4*s
        x123 = 1440*s
        x124 = 2160*x0
        x125 = 2880*x1
        x126 = 30*x26
        x127 = 2*s
        x128 = 3*x0
        x129 = 4*x1
        x130 = ks_2_1 + ks_2_2*x127 + ks_2_3*x128 + ks_2_4*x129
        x131 = ks_3_1 + ks_3_2*x127 + ks_3_3*x128 + ks_3_4*x129
        x132 = ks_4_1 + ks_4_2*x127 + ks_4_3*x128 + ks_4_4*x129
        x133 = ks_5_1 + ks_5_2*x127 + ks_5_3*x128 + ks_5_4*x129
        x134 = kn_4_3 + kn_4_4*x122
        x135 = kn_5_3 + kn_5_4*x122
        x136 = ks_3_3 + ks_3_4*x122
        x137 = ks_4_3 + ks_4_4*x122
        x138 = ks_5_3 + ks_5_4*x122
        x139 = 240*s
        x140 = 360*x0
        x141 = 480*x1
        x142 = kn_2_3 + kn_2_4*x122
        x143 = kn_3_3 + kn_3_4*x122
        x144 = kn_5_1 + kn_5_2*x127 + kn_5_3*x128 + kn_5_4*x129
        x145 = ks_1_3 + ks_1_4*x122
        x146 = ks_2_3 + ks_2_4*x122
        x147 = kn_3_1 + kn_3_2*x127 + kn_3_3*x128 + kn_3_4*x129
        x148 = kn_4_1 + kn_4_2*x127 + kn_4_3*x128 + kn_4_4*x129

        # Reduced expressions
        Bx = ks_0_0 + ks_0_1*s + ks_0_2*x0 + ks_0_3*x1 + ks_0_4*x2 + x*(ks_1_0 + x3 + x4 + x5 + x6) - x107*(120*kn_3_0 + 240*x100 + x101*x102 + x103*x59 + x104*x60 + x105*x40 + x74*x85 + 120*x75 + 120*x76 + 120*x77 + 120*x78 + x80*x87) + x11*x13 - x118*(720*ks_2_0 + 720*x10 + 1440*x108 + x109*x110 + x111*x95 + x112*x96 + x113*x45 + x114*x46 + x115*x25 + x116*x32 + x18*x97 + 720*x7 + 720*x8 + 720*x9) + x18*x20 + x25*x27 + x32*x34 - x41*(kn_4_4*x36 + kn_5_4*x37 + x35 + 720*x40) - x49*(51840*ks_3_4*x + ks_4_4*x43 + ks_5_4*x44 + x42 + 4320*x45 + x46*x47) + x64*(kn_2_4*x51 + kn_3_4*x53 + kn_4_4*x54 + 120*kn_5_0 + kn_5_4*x58 + x40*x62 + x50 + 120*x52 + 120*x55 + 120*x56 + 120*x57 + 480*x59 + x60*x61) + x89*(120*kn_1_0 + 120*x65 + 120*x66 + 120*x67 + 120*x68 + x73*x74 + x79*x80 + x85*x86 + x87*x88) + x99*(17280*ks_1_4*x + ks_2_4*x91 + ks_3_4*x92 + 720*ks_4_0 + ks_4_4*x93 + ks_5_4*x94 + 720*x21 + 720*x22 + 720*x23 + 720*x24 + x32*x97 + x45*x53 + x46*x54 + x51*x96 + x90 + 2880*x95)
        By = kn_0_0 + kn_0_1*s + kn_0_2*x0 + kn_0_3*x1 + kn_0_4*x2 + x*(kn_1_0 + x65 + x66 + x67 + x68) + (1/4320)*x106*(4320*bs_3 + 4320*bs_4*x122 + ks_1_4*x91 + ks_2_4*x92 + 720*ks_3_0 + ks_3_4*x93 + ks_4_4*x94 + 24*ks_5_4*x121 + x*x90 + 2880*x109 + x115*x32 + 720*x14 + 720*x15 + 720*x16 + 720*x17 + x25*x97 + x45*x54 + x46*x58 + x51*x95 + x53*x96) - 1/240*x117*(240*kn_0_2 + 240*kn_0_3*x38 + 240*kn_0_4*x39 + 120*kn_2_0 + x100*x102 + x101*x103 + x104*x59 + x105*x60 + 2*x33*x40 + 120*x69 + 120*x70 + 120*x71 + 120*x72 + x74*x79 + x80*x85 + x86*x87) + x13*x73 + x20*x79 + x27*x85 + x34*x87 - 1/86400*x48*(8640*kn_2_4 + kn_4_4*x37 + kn_5_4*x119 + x*x35 + x40*x97 + 720*x60) - 1/86400*x63*(51840*ks_1_4 + ks_3_4*x43 + ks_4_4*x44 + 720*ks_5_0 + 2160*ks_5_4*x26 + x*x42 + x120*x46 + 720*x28 + 720*x29 + 720*x30 + 720*x31 + x45*x47 + 4320*x96) + (1/2880)*x98*(2880*kn_0_4 + kn_2_4*x53 + kn_3_4*x54 + 120*kn_4_0 + kn_4_4*x58 + 24*kn_5_4*x33 + x*x50 + 480*x101 + 80*x19*x40 + x59*x61 + x60*x62 + x74*x87 + 120*x81 + 120*x82 + 120*x83 + 120*x84) - 1/720*y*(720*bs_1 + bs_2*x123 + bs_3*x124 + bs_4*x125 + 720*ks_1_0 + x108*x110 + x109*x111 + x11*x97 + x112*x95 + x113*x96 + x114*x45 + x115*x18 + x116*x25 + 2*x121*x46 + x126*x32 + 720*x3 + 720*x4 + 720*x5 + 720*x6)
        Bs = bs_0 + bs_1*s + bs_2*x0 + bs_3*x1 + bs_4*x2 + x*(ks_0_1 + ks_0_2*x127 + ks_0_3*x128 + ks_0_4*x129) - x107*(720*kn_0_3 + 720*kn_0_4*x122 + 120*kn_2_1 + kn_2_2*x139 + kn_2_3*x140 + kn_2_4*x141 + x115*x142 + x116*x143 + x126*x134 + 6*x135*x33 + x144*x86 + x147*x74 + x148*x80 + x97*(kn_1_3 + kn_1_4*x122)) - x118*(1440*bs_2 + 1440*bs_3*x38 + 1440*bs_4*x39 + 720*ks_1_1 + ks_1_2*x123 + ks_1_3*x124 + ks_1_4*x125 + x115*x131 + x116*x132 + x120*x145 + 6*x121*x138 + x126*x133 + x130*x97 + 180*x136*x26 + 36*x137*x33 + 720*x146*x19 + x47*(ks_0_3 + ks_0_4*x122)) + (1/720)*x121*x133 + x13*(ks_1_1 + ks_1_2*x127 + ks_1_3*x128 + ks_1_4*x129) + x130*x20 + x131*x27 + x132*x34 - x41*(2160*x*x135 + 2160*x134) - x49*(720*ks_5_1 + ks_5_2*x123 + ks_5_3*x124 + ks_5_4*x125 + 12960*x*x137 + 6480*x12*x138 + 12960*x136) + x64*(120*kn_4_1 + kn_4_2*x139 + kn_4_3*x140 + kn_4_4*x141 + x110*x143 + x111*x134 + x112*x135 + 1440*x142 + x144*x74) + x89*(120*kn_0_1 + kn_0_2*x139 + kn_0_3*x140 + kn_0_4*x141 + x144*x33 + x147*x86 + x148*x88 + x74*(kn_1_1 + kn_1_2*x127 + kn_1_3*x128 + kn_1_4*x129) + x80*(kn_2_1 + kn_2_2*x127 + kn_2_3*x128 + kn_2_4*x129)) + x99*(17280*bs_4 + 720*ks_3_1 + ks_3_2*x123 + ks_3_3*x124 + ks_3_4*x125 + x115*x133 + x119*x137 + x132*x97 + x136*x37 + 360*x138*x26 + 8640*x145 + x146*x36)
        return Bx, By, Bs

    elif multipole_order == 7:
        # Parameter list
        bs_0 = params[0]
        bs_1 = params[1]
        bs_2 = params[2]
        bs_3 = params[3]
        bs_4 = params[4]
        kn_0_0 = params[5]
        kn_0_1 = params[6]
        kn_0_2 = params[7]
        kn_0_3 = params[8]
        kn_0_4 = params[9]
        kn_1_0 = params[10]
        kn_1_1 = params[11]
        kn_1_2 = params[12]
        kn_1_3 = params[13]
        kn_1_4 = params[14]
        kn_2_0 = params[15]
        kn_2_1 = params[16]
        kn_2_2 = params[17]
        kn_2_3 = params[18]
        kn_2_4 = params[19]
        kn_3_0 = params[20]
        kn_3_1 = params[21]
        kn_3_2 = params[22]
        kn_3_3 = params[23]
        kn_3_4 = params[24]
        kn_4_0 = params[25]
        kn_4_1 = params[26]
        kn_4_2 = params[27]
        kn_4_3 = params[28]
        kn_4_4 = params[29]
        kn_5_0 = params[30]
        kn_5_1 = params[31]
        kn_5_2 = params[32]
        kn_5_3 = params[33]
        kn_5_4 = params[34]
        kn_6_0 = params[35]
        kn_6_1 = params[36]
        kn_6_2 = params[37]
        kn_6_3 = params[38]
        kn_6_4 = params[39]
        ks_0_0 = params[40]
        ks_0_1 = params[41]
        ks_0_2 = params[42]
        ks_0_3 = params[43]
        ks_0_4 = params[44]
        ks_1_0 = params[45]
        ks_1_1 = params[46]
        ks_1_2 = params[47]
        ks_1_3 = params[48]
        ks_1_4 = params[49]
        ks_2_0 = params[50]
        ks_2_1 = params[51]
        ks_2_2 = params[52]
        ks_2_3 = params[53]
        ks_2_4 = params[54]
        ks_3_0 = params[55]
        ks_3_1 = params[56]
        ks_3_2 = params[57]
        ks_3_3 = params[58]
        ks_3_4 = params[59]
        ks_4_0 = params[60]
        ks_4_1 = params[61]
        ks_4_2 = params[62]
        ks_4_3 = params[63]
        ks_4_4 = params[64]
        ks_5_0 = params[65]
        ks_5_1 = params[66]
        ks_5_2 = params[67]
        ks_5_3 = params[68]
        ks_5_4 = params[69]
        ks_6_0 = params[70]
        ks_6_1 = params[71]
        ks_6_2 = params[72]
        ks_6_3 = params[73]
        ks_6_4 = params[74]

        # Common sub-expressions
        x0 = s**2
        x1 = s**3
        x2 = s**4
        x3 = ks_1_1*s
        x4 = ks_1_2*x0
        x5 = ks_1_3*x1
        x6 = ks_1_4*x2
        x7 = ks_2_1*s
        x8 = ks_2_2*x0
        x9 = ks_2_3*x1
        x10 = ks_2_4*x2
        x11 = ks_2_0 + x10 + x7 + x8 + x9
        x12 = x**2
        x13 = (1/2)*x12
        x14 = ks_3_1*s
        x15 = ks_3_2*x0
        x16 = ks_3_3*x1
        x17 = ks_3_4*x2
        x18 = ks_3_0 + x14 + x15 + x16 + x17
        x19 = x**3
        x20 = (1/6)*x19
        x21 = ks_4_1*s
        x22 = ks_4_2*x0
        x23 = ks_4_3*x1
        x24 = ks_4_4*x2
        x25 = ks_4_0 + x21 + x22 + x23 + x24
        x26 = x**4
        x27 = (1/24)*x26
        x28 = ks_5_1*s
        x29 = ks_5_2*x0
        x30 = ks_5_3*x1
        x31 = ks_5_4*x2
        x32 = ks_5_0 + x28 + x29 + x30 + x31
        x33 = x**5
        x34 = (1/120)*x33
        x35 = ks_6_1*s
        x36 = ks_6_2*x0
        x37 = ks_6_3*x1
        x38 = ks_6_4*x2
        x39 = ks_6_0 + x35 + x36 + x37 + x38
        x40 = x**6
        x41 = (1/720)*x40
        x42 = 725760*ks_4_4
        x43 = 362880*x12
        x44 = 3*s
        x45 = 6*x0
        x46 = ks_6_2 + ks_6_3*x44 + ks_6_4*x45
        x47 = (1/203212800)*y**8
        x48 = 51840*kn_3_4
        x49 = 25920*x12
        x50 = 8640*x19
        x51 = kn_5_2 + kn_5_3*x44 + kn_5_4*x45
        x52 = kn_6_2 + kn_6_3*x44 + kn_6_4*x45
        x53 = 4320*x
        x54 = y**7
        x55 = (1/3628800)*x54
        x56 = 362880*ks_2_4
        x57 = 181440*x12
        x58 = 60480*x19
        x59 = 15120*x26
        x60 = ks_4_2 + ks_4_3*x44 + ks_4_4*x45
        x61 = ks_5_2 + ks_5_3*x44 + ks_5_4*x45
        x62 = 30240*x
        x63 = 15120*x12
        x64 = y**6
        x65 = (1/3628800)*x64
        x66 = 17280*kn_1_4
        x67 = kn_5_1*s
        x68 = 8640*x12
        x69 = 2880*x19
        x70 = kn_5_2*x0
        x71 = kn_5_3*x1
        x72 = kn_5_4*x2
        x73 = 720*x26
        x74 = 144*x33
        x75 = kn_3_2 + kn_3_3*x44 + kn_3_4*x45
        x76 = kn_4_2 + kn_4_3*x44 + kn_4_4*x45
        x77 = 2880*x
        x78 = 1440*x12
        x79 = 480*x19
        x80 = kn_6_1*s
        x81 = kn_6_2*x0
        x82 = kn_6_3*x1
        x83 = kn_6_4*x2
        x84 = kn_6_0 + x80 + x81 + x82 + x83
        x85 = 720*x
        x86 = y**5
        x87 = (1/86400)*x86
        x88 = kn_1_1*s
        x89 = kn_1_2*x0
        x90 = kn_1_3*x1
        x91 = kn_1_4*x2
        x92 = kn_2_1*s
        x93 = kn_2_2*x0
        x94 = kn_2_3*x1
        x95 = kn_2_4*x2
        x96 = kn_2_0 + x92 + x93 + x94 + x95
        x97 = kn_3_1*s
        x98 = kn_3_2*x0
        x99 = kn_3_3*x1
        x100 = kn_3_4*x2
        x101 = kn_3_0 + x100 + x97 + x98 + x99
        x102 = 360*x12
        x103 = kn_4_1*s
        x104 = kn_4_2*x0
        x105 = kn_4_3*x1
        x106 = kn_4_4*x2
        x107 = kn_4_0 + x103 + x104 + x105 + x106
        x108 = 120*x19
        x109 = kn_5_0 + x67 + x70 + x71 + x72
        x110 = 30*x26
        x111 = 6*x33
        x112 = (1/720)*y
        x113 = 120960*ks_0_4
        x114 = 120960*x
        x115 = 60480*x12
        x116 = 20160*x19
        x117 = 5040*x26
        x118 = 1008*x33
        x119 = 168*x40
        x120 = ks_2_2 + ks_2_3*x44 + ks_2_4*x45
        x121 = ks_3_2 + ks_3_3*x44 + ks_3_4*x45
        x122 = 20160*x
        x123 = 10080*x12
        x124 = 3360*x19
        x125 = 840*x26
        x126 = 5040*x
        x127 = 2520*x12
        x128 = y**4
        x129 = (1/120960)*x128
        x130 = kn_1_2 + kn_1_3*x44 + kn_1_4*x45
        x131 = kn_2_2 + kn_2_3*x44 + kn_2_4*x45
        x132 = 1440*x
        x133 = 720*x12
        x134 = 240*x19
        x135 = 60*x26
        x136 = 12*x33
        x137 = y**3
        x138 = (1/4320)*x137
        x139 = ks_0_2 + ks_0_3*x44 + ks_0_4*x45
        x140 = ks_1_2 + ks_1_3*x44 + ks_1_4*x45
        x141 = 10080*x
        x142 = 5040*x12
        x143 = 1680*x19
        x144 = 420*x26
        x145 = 84*x33
        x146 = 14*x40
        x147 = 840*x19
        x148 = 210*x26
        x149 = y**2
        x150 = (1/10080)*x149
        x151 = 2160*x12
        x152 = 5040*x19
        x153 = x**7
        x154 = 4*s
        x155 = 10080*s
        x156 = 15120*x0
        x157 = 20160*x1
        x158 = 42*x33
        x159 = 2*s
        x160 = 3*x0
        x161 = 4*x1
        x162 = ks_2_1 + ks_2_2*x159 + ks_2_3*x160 + ks_2_4*x161
        x163 = ks_3_1 + ks_3_2*x159 + ks_3_3*x160 + ks_3_4*x161
        x164 = ks_4_1 + ks_4_2*x159 + ks_4_3*x160 + ks_4_4*x161
        x165 = ks_5_1 + ks_5_2*x159 + ks_5_3*x160 + ks_5_4*x161
        x166 = ks_6_1 + ks_6_2*x159 + ks_6_3*x160 + ks_6_4*x161
        x167 = ks_5_3 + ks_5_4*x154
        x168 = ks_6_3 + ks_6_4*x154
        x169 = 1440*s
        x170 = 2160*x0
        x171 = 2880*x1
        x172 = kn_4_3 + kn_4_4*x154
        x173 = kn_5_3 + kn_5_4*x154
        x174 = kn_6_3 + kn_6_4*x154
        x175 = ks_3_3 + ks_3_4*x154
        x176 = ks_4_3 + ks_4_4*x154
        x177 = kn_2_3 + kn_2_4*x154
        x178 = kn_3_3 + kn_3_4*x154
        x179 = kn_5_1 + kn_5_2*x159 + kn_5_3*x160 + kn_5_4*x161
        x180 = kn_6_1 + kn_6_2*x159 + kn_6_3*x160 + kn_6_4*x161
        x181 = ks_1_3 + ks_1_4*x154
        x182 = ks_2_3 + ks_2_4*x154
        x183 = kn_3_1 + kn_3_2*x159 + kn_3_3*x160 + kn_3_4*x161
        x184 = kn_4_1 + kn_4_2*x159 + kn_4_3*x160 + kn_4_4*x161

        # Reduced expressions
        Bx = ks_0_0 + ks_0_1*s + ks_0_2*x0 + ks_0_3*x1 + ks_0_4*x2 + x*(ks_1_0 + x3 + x4 + x5 + x6) + x11*x13 + x112*(720*kn_1_0 + x101*x102 + x107*x108 + x109*x110 + x111*x84 + x85*x96 + 720*x88 + 720*x89 + 720*x90 + 720*x91) + x129*(ks_1_4*x114 + ks_2_4*x115 + ks_3_4*x116 + 5040*ks_4_0 + ks_4_4*x117 + ks_5_4*x118 + ks_6_4*x119 + x113 + 20160*x120 + x121*x122 + x123*x60 + x124*x61 + x125*x46 + x126*x32 + x127*x39 + 5040*x21 + 5040*x22 + 5040*x23 + 5040*x24) - x138*(720*kn_3_0 + 720*x100 + x102*x109 + x107*x85 + x108*x84 + 1440*x130 + x131*x132 + x133*x75 + x134*x76 + x135*x51 + x136*x52 + 720*x97 + 720*x98 + 720*x99) - x150*(5040*ks_2_0 + 5040*x10 + x120*x142 + x121*x143 + x126*x18 + x127*x25 + 10080*x139 + x140*x141 + x144*x60 + x145*x61 + x146*x46 + x147*x32 + x148*x39 + 5040*x7 + 5040*x8 + 5040*x9) + x18*x20 + x25*x27 + x32*x34 + x39*x41 + x47*(725760*ks_5_4*x + ks_6_4*x43 + x42 + 40320*x46) - x55*(51840*kn_4_4*x + kn_5_4*x49 + kn_6_4*x50 + x48 + 4320*x51 + x52*x53) - x65*(362880*ks_3_4*x + ks_4_4*x57 + ks_5_4*x58 + 5040*ks_6_0 + ks_6_4*x59 + 5040*x35 + 5040*x36 + 5040*x37 + 5040*x38 + x46*x63 + x56 + 30240*x60 + x61*x62) + x87*(17280*kn_2_4*x + kn_3_4*x68 + kn_4_4*x69 + 720*kn_5_0 + kn_5_4*x73 + kn_6_4*x74 + x51*x78 + x52*x79 + x66 + 720*x67 + 720*x70 + 720*x71 + 720*x72 + 2880*x75 + x76*x77 + x84*x85)
        By = kn_0_0 + kn_0_1*s + kn_0_2*x0 + kn_0_3*x1 + kn_0_4*x2 + x*(kn_1_0 + x88 + x89 + x90 + x91) + x101*x20 + x107*x27 + x109*x34 + (1/17280)*x128*(17280*kn_0_4 + kn_2_4*x68 + kn_3_4*x69 + 720*kn_4_0 + kn_4_4*x73 + kn_5_4*x74 + 24*kn_6_4*x40 + x*x66 + x102*x84 + 720*x103 + 720*x104 + 720*x105 + 720*x106 + x109*x85 + 2880*x131 + 120*x26*x52 + x51*x79 + x75*x77 + x76*x78) + x13*x96 + (1/30240)*x137*(30240*bs_3 + 30240*bs_4*x154 + ks_1_4*x115 + ks_2_4*x116 + 5040*ks_3_0 + ks_3_4*x117 + ks_4_4*x118 + ks_5_4*x119 + 24*ks_6_4*x153 + x*x113 + x120*x122 + x121*x123 + x124*x60 + x125*x61 + x126*x25 + x127*x32 + 5040*x14 + 20160*x140 + x147*x39 + 5040*x15 + 5040*x16 + 5040*x17 + 168*x33*x46) - 1/1440*x149*(1440*kn_0_2 + 1440*kn_0_3*x44 + 1440*kn_0_4*x45 + 720*kn_2_0 + x101*x85 + x102*x107 + x108*x109 + x110*x84 + x130*x132 + x131*x133 + x134*x75 + x135*x76 + x136*x51 + 2*x40*x52 + 720*x92 + 720*x93 + 720*x94 + 720*x95) + x41*x84 + (1/25401600)*x54*(725760*ks_3_4 + ks_5_4*x43 + 120960*ks_6_4*x19 + x*x42 + 40320*x*x46 + 40320*x61) - 1/518400*x64*(51840*kn_2_4 + kn_4_4*x49 + kn_5_4*x50 + 720*kn_6_0 + 2160*kn_6_4*x26 + x*x48 + x151*x52 + x51*x53 + 4320*x76 + 720*x80 + 720*x81 + 720*x82 + 720*x83) - 1/604800*x86*(362880*ks_1_4 + ks_3_4*x57 + ks_4_4*x58 + 5040*ks_5_0 + ks_5_4*x59 + 3024*ks_6_4*x33 + x*x56 + 30240*x121 + x126*x39 + x152*x46 + 5040*x28 + 5040*x29 + 5040*x30 + 5040*x31 + x60*x62 + x61*x63) - 1/5040*y*(5040*bs_1 + bs_2*x155 + bs_3*x156 + bs_4*x157 + 5040*ks_1_0 + x11*x126 + x120*x143 + x121*x144 + x127*x18 + x139*x141 + x140*x142 + x145*x60 + x146*x61 + x147*x25 + x148*x32 + 2*x153*x46 + x158*x39 + 5040*x3 + 5040*x4 + 5040*x5 + 5040*x6)
        Bs = bs_0 + bs_1*s + bs_2*x0 + bs_3*x1 + bs_4*x2 + x*(ks_0_1 + ks_0_2*x159 + ks_0_3*x160 + ks_0_4*x161) + x112*(720*kn_0_1 + kn_0_2*x169 + kn_0_3*x170 + kn_0_4*x171 + x102*(kn_2_1 + kn_2_2*x159 + kn_2_3*x160 + kn_2_4*x161) + x108*x183 + x110*x184 + x111*x179 + x180*x40 + x85*(kn_1_1 + kn_1_2*x159 + kn_1_3*x160 + kn_1_4*x161)) + x129*(120960*bs_4 + 5040*ks_3_1 + ks_3_2*x155 + ks_3_3*x156 + ks_3_4*x157 + 60480*x*x182 + 30240*x12*x175 + x126*x164 + x127*x165 + x147*x166 + 2520*x167*x26 + 504*x168*x33 + 10080*x176*x19 + 60480*x181) + x13*(ks_1_1 + ks_1_2*x159 + ks_1_3*x160 + ks_1_4*x161) - x138*(4320*kn_0_3 + 4320*kn_0_4*x154 + 720*kn_2_1 + kn_2_2*x169 + kn_2_3*x170 + kn_2_4*x171 + x102*x184 + x108*x179 + x110*x180 + x151*x177 + 180*x172*x26 + 36*x173*x33 + 6*x174*x40 + 720*x178*x19 + x183*x85 + x53*(kn_1_3 + kn_1_4*x154)) - x150*(10080*bs_2 + 10080*bs_3*x44 + 10080*bs_4*x45 + 5040*ks_1_1 + ks_1_2*x155 + ks_1_3*x156 + ks_1_4*x157 + x126*x162 + x127*x163 + x147*x164 + x148*x165 + x152*x182 + 6*x153*x168 + x158*x166 + 42*x167*x40 + 1260*x175*x26 + 252*x176*x33 + x181*x63 + x62*(ks_0_3 + ks_0_4*x154)) + (1/5040)*x153*x166 + x162*x20 + x163*x27 + x164*x34 + x165*x41 + x47*(x114*x168 + 120960*x167) - x55*(720*kn_6_1 + kn_6_2*x169 + kn_6_3*x170 + kn_6_4*x171 + 12960*x*x173 + 6480*x12*x174 + 12960*x172) - x65*(5040*ks_5_1 + ks_5_2*x155 + ks_5_3*x156 + ks_5_4*x157 + 90720*x*x176 + 45360*x12*x167 + x126*x166 + 15120*x168*x19 + 90720*x175) + x87*(720*kn_4_1 + kn_4_2*x169 + kn_4_3*x170 + kn_4_4*x171 + 8640*x*x178 + x102*x180 + 4320*x12*x172 + 1440*x173*x19 + 360*x174*x26 + 8640*x177 + x179*x85)
        return Bx, By, Bs

    raise ValueError(f'Unsupported multipole order {multipole_order}; supported orders are 1 to 7')
